---
import Layout from '~/layouts/PageLayout.astro';
import { Icon } from 'astro-icon/components';
import { client } from '~/lib/sanity';

// Sanity'den 'contact' tipindeki tek dökümanı çekiyoruz
const contactData = await client.fetch(`*[_type == "contact"][0]`);

const metadata = {
  title: `${contactData.title} - Uzman Diyetisyen Feyza Subaşı`,
  description: contactData.intro || 'Benimle iletişime geçin, sorularınızı sorun veya randevu alın.',
};
---

<Layout metadata={metadata}>
  <section class="px-4 py-16 sm:py-20">
    <div class="mx-auto max-w-4xl">
      <div class="mb-10 md:mb-16">
        <h1 class="mb-4 text-center text-4xl font-bold md:text-5xl">{contactData.title}</h1>
        {contactData.intro && (
          <p class="text-center text-xl text-muted">
            {contactData.intro}
          </p>
        )}
      </div>

      <div class="grid grid-cols-1 gap-10 md:grid-cols-2">
        <div class="p-6">
          <h2 class="mb-4 text-2xl font-bold">İletişim Bilgileri</h2>
          
          {contactData.phone && (
            <div class="mb-4 flex items-start">
              <Icon name="tabler:phone" class="mr-3 mt-1 h-6 w-6 text-primary" />
              <div>
                <h3 class="font-semibold">Telefon</h3>
                <p>{contactData.phone}</p>
              </div>
            </div>
          )}

          {contactData.email && (
            <div class="mb-4 flex items-start">
              <Icon name="tabler:mail" class="mr-3 mt-1 h-6 w-6 text-primary" />
              <div>
                <h3 class="font-semibold">E-posta</h3>
                <p>{contactData.email}</p>
              </div>
            </div>
          )}

          {contactData.address && (
            <div class="mb-4 flex items-start">
              <Icon name="tabler:map-pin" class="mr-3 mt-1 h-6 w-6 text-primary" />
              <div>
                <h3 class="font-semibold">Adres</h3>
                <p style="white-space: pre-wrap;">{contactData.address}</p>
              </div>
            </div>
          )}
        </div>

        <div class="p-6">
          <h2 class="mb-4 text-2xl font-bold">Mesaj Gönderin</h2>
          
          <form name="contact" data-netlify="true" netlify-honeypot="bot-field">
            <input type="hidden" name="form-name" value="contact" />
            <p class="hidden">
                <label>Bu alanı doldurmayın: <input name="bot-field" /></label>
            </p>

            <div class="mb-4">
              <label class="mb-1 block font-medium" for="name">Adınız Soyadınız</label>
              <input type="text" id="name" name="name" required class="w-full rounded border border-gray-300 px-3 py-2 focus:border-primary focus:outline-none" />
            </div>
            <div class="mb-4">
              <label class="mb-1 block font-medium" for="email">E-posta Adresiniz</label>
              <input type="email" id="email" name="email" required class="w-full rounded border border-gray-300 px-3 py-2 focus:border-primary focus:outline-none" />
            </div>
            <div class="mb-4">
              <label class="mb-1 block font-medium" for="message">Mesajınız</label>
              <textarea id="message" name="message" rows="4" required class="w-full rounded border border-gray-300 px-3 py-2 focus:border-primary focus:outline-none"></textarea>
            </div>
            <button type="submit" class="w-full rounded bg-primary px-4 py-2 font-bold text-white hover:bg-primary-dark">
              Gönder
            </button>
          </form>
        </div>
      </div>
    </div>
  </section>
</Layout>