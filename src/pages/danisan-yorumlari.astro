---
import Layout from '~/layouts/PageLayout.astro';
import { Icon } from 'astro-icon/components';
import { client, urlFor } from '~/lib/sanity';

// Sanity'den tüm müşteri yorumlarını çekiyoruz
const testimonials = await client.fetch(`*[_type == "testimonial"] | order(_createdAt desc)`);

const metadata = {
  title: 'Danışan Yorumları - Feyza Subaşı',
  description: 'Danışanlarımın başarı hikayelerini ve benimle olan deneyimlerini okuyun.',
};
---

<Layout metadata={metadata}>
  <section class="px-4 py-16 sm:py-20">
    <div class="mx-auto max-w-5xl">
      <div class="mb-10 text-center md:mb-16">
        <h1 class="mb-4 text-4xl font-bold md:text-5xl">Danışanlarımız Ne Dedi?</h1>
        <p class="text-xl text-muted">Gerçek başarı hikayeleri, gerçek sonuçlar.</p>
      </div>

      <div class="grid grid-cols-1 gap-8 md:grid-cols-2">
        {
          testimonials.map((testimonial) => (
            <div class="flex flex-col rounded-lg border border-gray-200 bg-white p-6 shadow-md dark:border-slate-700 dark:bg-slate-800">
              <div class="flex-grow">
                <Icon name="tabler:quote" class="h-8 w-8 text-primary" />
                <p class="mt-4 text-lg text-gray-700 dark:text-slate-400">"{testimonial.quote}"</p>
              </div>
              <div class="mt-6 flex items-center">
                {testimonial.image && (
                    <img
                        class="mr-4 h-12 w-12 rounded-full object-cover"
                        src={urlFor(testimonial.image).width(100).height(100).url()}
                        alt={testimonial.name}
                    />
                )}
                <div>
                  <p class="font-bold text-lg">{testimonial.name}</p>
                  {testimonial.title && <p class="text-sm text-primary">{testimonial.title}</p>}
                </div>
              </div>
            </div>
          ))
        }
      </div>
    </div>
  </section>
</Layout>